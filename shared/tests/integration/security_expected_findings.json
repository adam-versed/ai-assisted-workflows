{
  "metadata": {
    "version": "1.0",
    "description": "Expected security findings for vulnerable test applications",
    "last_updated": "2025-01-23",
    "total_applications": 14
  },
  "applications": {
    "test-javascript": {
      "language": "javascript",
      "framework": "node.js/express",
      "source": "test_codebase/vulnerable-apps/test-javascript",
      "expected_vulnerabilities": {
        "owasp_top_10": {
          "A01_injection": {
            "sql_injection": {
              "locations": [
                "app/routes/contributions.js",
                "app/routes/allocations.js"
              ],
              "severity": "critical",
              "cwe": "CWE-89",
              "description": "NoSQL injection in MongoDB queries"
            },
            "command_injection": {
              "locations": ["app/routes/contributions.js"],
              "severity": "critical",
              "cwe": "CWE-78",
              "description": "OS command injection via eval() usage"
            }
          },
          "A03_sensitive_data": {
            "hardcoded_secrets": {
              "locations": ["app/data/user-dao.js"],
              "severity": "medium",
              "cwe": "CWE-798",
              "description": "Base64 high entropy string in configuration"
            }
          },
          "A03_cross_site_scripting": {
            "xss": {
              "locations": ["app/routes/contributions.js"],
              "severity": "high",
              "cwe": "CWE-79",
              "description": "Cross-site scripting in user input"
            }
          },
          "A07_identification_failures": {
            "insecure_direct_object_references": {
              "locations": ["app/routes/allocations.js"],
              "severity": "high",
              "cwe": "CWE-639",
              "description": "Direct object references without authorization checks"
            }
          }
        }
      }
    },
    "test-python": {
      "language": "python",
      "framework": "django",
      "source": "test_codebase/vulnerable-apps/test-python",
      "expected_vulnerabilities": {
        "owasp_top_10": {
          "A01_injection": {
            "sql_injection": {
              "locations": ["introduction/views.py"],
              "severity": "critical",
              "cwe": "CWE-89",
              "description": "SQL injection via raw queries"
            },
            "command_injection": {
              "locations": ["introduction/views.py"],
              "severity": "critical",
              "cwe": "CWE-78",
              "description": "OS command injection"
            }
          },
          "A03_sensitive_data": {
            "hardcoded_secrets": {
              "locations": ["pygoat/settings.py"],
              "severity": "critical",
              "cwe": "CWE-798",
              "description": "AWS access key, GitHub token, and base64 high entropy string"
            }
          },
          "A07_identification_failures": {
            "broken_access_control": {
              "locations": ["introduction/views.py"],
              "severity": "high",
              "cwe": "CWE-284",
              "description": "Missing authorization checks"
            }
          },
          "A10_ssrf": {
            "server_side_request_forgery": {
              "locations": ["introduction/views.py"],
              "severity": "medium",
              "cwe": "CWE-918",
              "description": "SSRF via requests library"
            }
          }
        }
      }
    },
    "test-flask": {
      "language": "python",
      "framework": "flask",
      "source": "test_codebase/vulnerable-apps/test-flask",
      "expected_vulnerabilities": {
        "owasp_top_10": {
          "A01_injection": {
            "sql_injection": {
              "locations": ["app.py"],
              "severity": "critical",
              "cwe": "CWE-89",
              "description": "SQL injection in login endpoint"
            },
            "template_injection": {
              "locations": ["app.py"],
              "severity": "high",
              "cwe": "CWE-1336",
              "description": "Server-side template injection (SSTI)"
            }
          },
          "A02_broken_authentication": {
            "weak_passwords": {
              "locations": ["app.py"],
              "severity": "medium",
              "cwe": "CWE-521",
              "description": "Weak password requirements"
            }
          },
          "A03_sensitive_data": {
            "information_disclosure": {
              "locations": ["app.py"],
              "severity": "medium",
              "cwe": "CWE-200",
              "description": "Sensitive information in error messages"
            }
          }
        }
      }
    },
    "test-php": {
      "language": "php",
      "framework": "php",
      "source": "test_codebase/vulnerable-apps/test-php",
      "expected_vulnerabilities": {
        "owasp_top_10": {
          "A01_injection": {
            "sql_injection": {
              "locations": [
                "vulnerabilities/sqli/source/low.php",
                "vulnerabilities/sqli_blind/source/low.php"
              ],
              "severity": "critical",
              "cwe": "CWE-89",
              "description": "SQL injection vulnerabilities"
            },
            "command_injection": {
              "locations": ["vulnerabilities/exec/source/low.php"],
              "severity": "critical",
              "cwe": "CWE-78",
              "description": "OS command injection"
            }
          },
          "A03_cross_site_scripting": {
            "reflected_xss": {
              "locations": ["vulnerabilities/xss_r/source/low.php"],
              "severity": "high",
              "cwe": "CWE-79",
              "description": "Reflected cross-site scripting"
            },
            "stored_xss": {
              "locations": ["vulnerabilities/xss_s/source/low.php"],
              "severity": "high",
              "cwe": "CWE-79",
              "description": "Stored cross-site scripting"
            }
          },
          "A05_security_misconfiguration": {
            "csrf": {
              "locations": ["vulnerabilities/csrf/source/low.php"],
              "severity": "medium",
              "cwe": "CWE-352",
              "description": "Cross-site request forgery"
            }
          },
          "A08_software_integrity": {
            "file_upload": {
              "locations": ["vulnerabilities/upload/source/low.php"],
              "severity": "critical",
              "cwe": "CWE-434",
              "description": "Unrestricted file upload"
            }
          }
        }
      }
    },
    "test-java": {
      "language": "java",
      "framework": "spring-boot",
      "source": "test_codebase/vulnerable-apps/test-java",
      "expected_vulnerabilities": {
        "owasp_top_10": {
          "A01_injection": {
            "sql_injection": {
              "locations": [
                "src/main/java/com/example/webapp/controller/UserController.java"
              ],
              "severity": "critical",
              "cwe": "CWE-89",
              "description": "SQL injection in authentication and profile endpoints"
            },
            "command_injection": {
              "locations": [
                "src/main/java/com/example/webapp/controller/UserController.java"
              ],
              "severity": "critical",
              "cwe": "CWE-78",
              "description": "OS command injection via executeCommand endpoint"
            }
          },
          "A03_sensitive_data": {
            "hardcoded_secrets": {
              "locations": [
                "src/main/java/com/example/webapp/service/UserService.java",
                "src/main/resources/application.properties"
              ],
              "severity": "critical",
              "cwe": "CWE-798",
              "description": "Multiple hardcoded secrets including API keys, JWT secrets, and database passwords"
            }
          },
          "A03_cross_site_scripting": {
            "xss": {
              "locations": [
                "src/main/java/com/example/webapp/controller/UserController.java"
              ],
              "severity": "high",
              "cwe": "CWE-79",
              "description": "Cross-site scripting in search functionality"
            }
          },
          "A06_vulnerable_components": {
            "path_traversal": {
              "locations": [
                "src/main/java/com/example/webapp/service/UserService.java"
              ],
              "severity": "high",
              "cwe": "CWE-22",
              "description": "Path traversal in file processing"
            }
          },
          "A08_software_integrity": {
            "insecure_deserialization": {
              "locations": [
                "src/main/java/com/example/webapp/service/UserService.java"
              ],
              "severity": "high",
              "cwe": "CWE-502",
              "description": "Insecure object deserialization"
            }
          }
        }
      }
    },
    "test-go": {
      "language": "go",
      "framework": "go",
      "source": "test_codebase/vulnerable-apps/test-go",
      "expected_vulnerabilities": {
        "owasp_top_10": {
          "A01_injection": {
            "sql_injection": {
              "locations": [
                "internal/handlers/auth.go",
                "internal/handlers/users.go"
              ],
              "severity": "critical",
              "cwe": "CWE-89",
              "description": "SQL injection in authentication and user retrieval"
            },
            "command_injection": {
              "locations": ["internal/handlers/users.go"],
              "severity": "critical",
              "cwe": "CWE-78",
              "description": "OS command injection via file handler"
            }
          },
          "A03_sensitive_data": {
            "hardcoded_secrets": {
              "locations": [
                "internal/handlers/auth.go",
                "internal/models/user.go"
              ],
              "severity": "critical",
              "cwe": "CWE-798",
              "description": "Database passwords, JWT secrets, and API keys"
            }
          },
          "A03_cross_site_scripting": {
            "xss": {
              "locations": ["internal/handlers/users.go"],
              "severity": "high",
              "cwe": "CWE-79",
              "description": "Cross-site scripting in search functionality"
            }
          }
        }
      }
    },
    "test-go-advanced": {
      "language": "go",
      "framework": "go",
      "source": "test_codebase/vulnerable-apps/test-go-advanced",
      "expected_vulnerabilities": {
        "language_specific": {
          "unsafe_usage": {
            "locations": ["internal/unsafe/unsafe_operations.go"],
            "severity": "high",
            "cwe": "CWE-119",
            "description": "Unsafe pointer operations and memory manipulation"
          },
          "race_conditions": {
            "locations": ["internal/race/race_conditions.go"],
            "severity": "medium",
            "cwe": "CWE-362",
            "description": "Data race conditions in concurrent access"
          },
          "memory_leaks": {
            "locations": ["internal/memory/memory_leaks.go"],
            "severity": "medium",
            "cwe": "CWE-401",
            "description": "Memory leaks through unmanaged goroutines"
          }
        }
      }
    },
    "test-rust": {
      "language": "rust",
      "framework": "rust",
      "source": "test_codebase/vulnerable-apps/test-rust",
      "expected_vulnerabilities": {
        "owasp_top_10": {
          "A01_injection": {
            "command_injection": {
              "locations": ["src/main.rs", "src/web/server.rs"],
              "severity": "critical",
              "cwe": "CWE-78",
              "description": "Command injection through user input"
            },
            "sql_injection": {
              "locations": ["src/examples/web_vulns.rs", "src/web/server.rs"],
              "severity": "critical",
              "cwe": "CWE-89",
              "description": "SQL injection in query building"
            }
          },
          "A03_sensitive_data": {
            "hardcoded_secrets": {
              "locations": ["src/main.rs", "src/examples/web_vulns.rs"],
              "severity": "critical",
              "cwe": "CWE-798",
              "description": "API keys, JWT secrets, private keys, AWS secrets, and GitHub tokens"
            }
          },
          "A06_vulnerable_components": {
            "path_traversal": {
              "locations": ["src/main.rs"],
              "severity": "high",
              "cwe": "CWE-22",
              "description": "Path traversal vulnerability"
            }
          },
          "A08_software_integrity": {
            "insecure_deserialization": {
              "locations": ["src/examples/web_vulns.rs"],
              "severity": "high",
              "cwe": "CWE-502",
              "description": "Insecure deserialization"
            }
          }
        },
        "language_specific": {
          "buffer_overflow": {
            "locations": ["src/main.rs"],
            "severity": "critical",
            "cwe": "CWE-120",
            "description": "Buffer overflow in unsafe block"
          },
          "use_after_free": {
            "locations": ["src/main.rs"],
            "severity": "critical",
            "cwe": "CWE-416",
            "description": "Use after free vulnerability"
          },
          "memory_corruption": {
            "locations": ["src/examples/web_vulns.rs"],
            "severity": "high",
            "cwe": "CWE-119",
            "description": "Memory corruption in unsafe operations"
          }
        }
      }
    },
    "test-sql": {
      "language": "sql",
      "framework": "sql",
      "source": "test_codebase/vulnerable-apps/test-sql",
      "expected_vulnerabilities": {
        "security_issues": {
          "plaintext_passwords": {
            "locations": ["schemas/vulnerable_schema.sql"],
            "severity": "critical",
            "cwe": "CWE-256",
            "description": "Plain text password storage"
          },
          "pii_exposure": {
            "locations": ["schemas/vulnerable_schema.sql"],
            "severity": "high",
            "cwe": "CWE-359",
            "description": "PII stored without encryption"
          },
          "sql_injection": {
            "locations": ["queries/injection_examples.sql"],
            "severity": "critical",
            "cwe": "CWE-89",
            "description": "SQL injection patterns"
          },
          "information_disclosure": {
            "locations": ["schemas/vulnerable_schema.sql"],
            "severity": "medium",
            "cwe": "CWE-200",
            "description": "Debug tables exposing sensitive data"
          }
        },
        "performance_issues": {
          "missing_indexes": {
            "locations": ["queries/performance_issues.sql"],
            "severity": "medium",
            "description": "Queries without proper indexes"
          },
          "select_star": {
            "locations": ["queries/performance_issues.sql"],
            "severity": "low",
            "description": "SELECT * usage"
          },
          "n_plus_one": {
            "locations": ["queries/performance_issues.sql"],
            "severity": "medium",
            "description": "N+1 query problems"
          }
        }
      }
    },
    "test-csharp": {
      "language": "csharp",
      "framework": "asp.net-core",
      "source": "test_codebase/vulnerable-apps/test-csharp",
      "expected_vulnerabilities": {
        "owasp_top_10": {
          "A01_injection": {
            "sql_injection": {
              "locations": ["Controllers/AuthController.cs"],
              "severity": "critical",
              "cwe": "CWE-89",
              "description": "SQL injection in login and profile endpoints"
            },
            "command_injection": {
              "locations": ["Controllers/UserController.cs"],
              "severity": "critical",
              "cwe": "CWE-78",
              "description": "OS command injection via executeCommand endpoint"
            }
          },
          "A03_sensitive_data": {
            "hardcoded_secrets": {
              "locations": [
                "Controllers/AuthController.cs",
                "Services/AuthService.cs",
                "Services/UserService.cs",
                "Data/ApplicationDbContext.cs",
                "appsettings.json"
              ],
              "severity": "critical",
              "cwe": "CWE-798",
              "description": "Multiple hardcoded secrets including JWT keys, API keys, database passwords, and private keys"
            }
          },
          "A03_cross_site_scripting": {
            "xss": {
              "locations": ["Controllers/UserController.cs"],
              "severity": "high",
              "cwe": "CWE-79",
              "description": "Cross-site scripting in search endpoint"
            }
          },
          "A08_software_integrity": {
            "insecure_deserialization": {
              "locations": ["Controllers/UserController.cs"],
              "severity": "high",
              "cwe": "CWE-502",
              "description": "Insecure binary deserialization"
            },
            "path_traversal": {
              "locations": ["Controllers/UserController.cs"],
              "severity": "high",
              "cwe": "CWE-22",
              "description": "Path traversal in file reading endpoint"
            }
          }
        }
      }
    },
    "clean-python": {
      "language": "python",
      "framework": "python",
      "source": "test_codebase/clean-apps/clean-python",
      "expected_vulnerabilities": {}
    },
    "clean-javascript": {
      "language": "javascript",
      "framework": "node.js",
      "source": "test_codebase/clean-apps/clean-javascript",
      "expected_vulnerabilities": {}
    },
    "clean-java": {
      "language": "java",
      "framework": "java",
      "source": "test_codebase/clean-apps/clean-java",
      "expected_vulnerabilities": {}
    },
    "clean-go": {
      "language": "go",
      "framework": "go",
      "source": "test_codebase/clean-apps/clean-go",
      "expected_vulnerabilities": {}
    },
    "clean-csharp": {
      "language": "csharp",
      "framework": "csharp",
      "source": "test_codebase/clean-apps/clean-csharp",
      "expected_vulnerabilities": {}
    }
  },
  "analyzer_mapping": {
    "semgrep_analyzer": {
      "should_detect": [
        "A01_injection",
        "A03_cross_site_scripting",
        "command_injection",
        "sql_injection",
        "xss",
        "hardcoded_secrets",
        "unsafe_usage",
        "path_traversal",
        "template_injection"
      ],
      "languages": ["javascript", "python", "java", "go", "rust", "csharp"]
    },
    "detect_secrets_analyzer": {
      "should_detect": [
        "hardcoded_secrets",
        "plaintext_passwords",
        "api_keys",
        "database_credentials",
        "secret_tokens"
      ],
      "languages": [
        "javascript",
        "python",
        "java",
        "go",
        "php",
        "rust",
        "csharp"
      ]
    },
    "sqlfluff_analyzer": {
      "should_detect": [
        "sql_injection",
        "performance_issues",
        "missing_indexes",
        "select_star",
        "plaintext_passwords",
        "pii_exposure"
      ],
      "languages": ["sql"]
    }
  }
}
